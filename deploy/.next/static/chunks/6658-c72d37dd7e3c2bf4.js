"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[6658],{495:function(e,t,n){n.d(t,{z:function(){return l}});var r=n(7437),o=n(2265),a=n(1538),i=n(3027),s=n(7440);let c=(0,i.j)("inline-flex items-center justify-center whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-all duration-300 focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50",{variants:{variant:{default:"bg-primary text-primary-foreground hover:bg-primary/90 neon-glow",destructive:"bg-destructive text-destructive-foreground hover:bg-destructive/90",outline:"border border-input bg-background hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-10 px-4 py-2",sm:"h-9 rounded-md px-3",lg:"h-11 rounded-md px-8",icon:"h-10 w-10"}},defaultVariants:{variant:"default",size:"default"}}),l=o.forwardRef((e,t)=>{let{className:n,variant:o,size:i,asChild:l=!1,...u}=e,d=l?a.g7:"button";return(0,r.jsx)(d,{className:(0,s.cn)(c({variant:o,size:i,className:n})),ref:t,...u})});l.displayName="Button"},6013:function(e,t,n){n.d(t,{Ol:function(){return s},SZ:function(){return l},Zb:function(){return i},aY:function(){return u},eW:function(){return d},ll:function(){return c}});var r=n(7437),o=n(2265),a=n(7440);let i=o.forwardRef((e,t)=>{let{className:n,...o}=e;return(0,r.jsx)("div",{ref:t,className:(0,a.cn)("rounded-lg border bg-card text-card-foreground shadow-sm glass-card card-hover",n),...o})});i.displayName="Card";let s=o.forwardRef((e,t)=>{let{className:n,...o}=e;return(0,r.jsx)("div",{ref:t,className:(0,a.cn)("flex flex-col space-y-1.5 p-6",n),...o})});s.displayName="CardHeader";let c=o.forwardRef((e,t)=>{let{className:n,...o}=e;return(0,r.jsx)("h3",{ref:t,className:(0,a.cn)("text-2xl font-semibold leading-none tracking-tight",n),...o})});c.displayName="CardTitle";let l=o.forwardRef((e,t)=>{let{className:n,...o}=e;return(0,r.jsx)("p",{ref:t,className:(0,a.cn)("text-sm text-muted-foreground",n),...o})});l.displayName="CardDescription";let u=o.forwardRef((e,t)=>{let{className:n,...o}=e;return(0,r.jsx)("div",{ref:t,className:(0,a.cn)("p-6 pt-0",n),...o})});u.displayName="CardContent";let d=o.forwardRef((e,t)=>{let{className:n,...o}=e;return(0,r.jsx)("div",{ref:t,className:(0,a.cn)("flex items-center p-6 pt-0",n),...o})});d.displayName="CardFooter"},5591:function(e,t,n){n.d(t,{AC:function(){return S},F$:function(){return T},Xo:function(){return w},ZM:function(){return f},eJ:function(){return N},g8:function(){return E},iJ:function(){return h},mJ:function(){return v},nJ:function(){return b},ot:function(){return k},s$:function(){return g},x2:function(){return m}});let r=n(357).env.NEXT_PUBLIC_API_URL||"http://localhost:8000",o="user",a="token",i="refreshToken",s=!1,c=[],l=e=>{c.push(e)},u=e=>{c.forEach(t=>t(e)),c=[]},d={getToken:()=>localStorage.getItem(a),setToken:e=>localStorage.setItem(a,e),removeToken:()=>localStorage.removeItem(a),getRefreshToken:()=>localStorage.getItem(i),setRefreshToken:e=>localStorage.setItem(i,e),removeRefreshToken:()=>localStorage.removeItem(i),clearAll:()=>{d.removeToken(),d.removeRefreshToken(),localStorage.removeItem(o)}},f={getUser:()=>{let e=localStorage.getItem(o);if(!e)return null;try{return JSON.parse(e)}catch(e){return null}},setUser:e=>localStorage.setItem(o,JSON.stringify(e)),removeUser:()=>localStorage.removeItem(o)};function m(e){alert(e),console.error(e)}function g(e){{let t=document.createElement("div");t.className="fixed bottom-4 right-4 bg-green-500 text-white px-4 py-2 rounded shadow-lg z-50 animate-fade-in",t.textContent=e,document.body.appendChild(t),setTimeout(()=>t.remove(),3e3)}}async function p(){let e=d.getRefreshToken();if(!e)return!1;if(s)return new Promise(e=>{let t=setTimeout(()=>{c=c.filter(e=>e!==u),e(!1)},1e4);l(n=>{clearTimeout(t),e(!0)})});s=!0;try{let t=new AbortController,n=setTimeout(()=>t.abort(),1e4),o=await fetch("".concat(r,"/api/auth/refresh"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({refresh_token:e}),signal:t.signal});if(clearTimeout(n),!o.ok)return d.clearAll(),setTimeout(()=>{window.dispatchEvent(new CustomEvent("auth:logout"))},100),!1;{let e=await o.json();return d.setToken(e.access_token),u(e.access_token),!0}}catch(e){return!1}finally{s=!1}}async function y(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,o="".concat(r).concat(e),a=new AbortController,i=setTimeout(()=>a.abort(),15e3);try{let r=await fetch(o,{...t,headers:{"Content-Type":"application/json",...function(){let e=d.getToken();return e?{Authorization:"Bearer ".concat(e)}:{}}(),...t.headers},signal:a.signal});if(clearTimeout(i),401===r.status&&n>0&&await p())return y(e,t,n-1);if(401===r.status&&0===n)throw d.clearAll(),setTimeout(()=>{window.dispatchEvent(new CustomEvent("auth:logout"))},100),Error("登录已过期，请重新登录");if(!r.ok){let e=await r.json().catch(()=>({detail:"请求失败"})),t=e.detail||e.message||"请求失败";throw m(t),Error(t)}let s=r.headers.get("content-type");if(s&&s.includes("application/json"))return r.json();return{}}catch(e){if(clearTimeout(i),e instanceof Error&&"AbortError"===e.name)throw Error("请求超时，请稍后重试");throw e}}let h={login:async(e,t)=>{let n=await y("/api/auth/login",{method:"POST",body:JSON.stringify({email:e,password:t})});return d.setToken(n.access_token),n.refresh_token&&d.setRefreshToken(n.refresh_token),n},register:async(e,t,n)=>{let r=await y("/api/auth/register",{method:"POST",body:JSON.stringify({email:e,password:t,name:n})});return d.setToken(r.access_token),r.refresh_token&&d.setRefreshToken(r.refresh_token),r},logout:()=>{d.clearAll()},getCurrentUser:async()=>y("/api/auth/me"),refreshToken:async()=>{let e=d.getRefreshToken();if(!e)throw Error("No refresh token available");let t=await y("/api/auth/refresh",{method:"POST",body:JSON.stringify({refresh_token:e})});return d.setToken(t.access_token),t},isAuthenticated:()=>!!d.getToken(),isAdmin:()=>{let e=f.getUser();return(null==e?void 0:e.role)==="ADMIN"}},S={list:async e=>{let t=new URLSearchParams;(null==e?void 0:e.page)&&t.set("page",String(e.page)),(null==e?void 0:e.limit)&&t.set("limit",String(e.limit)),(null==e?void 0:e.search)&&t.set("search",e.search);let n=t.toString()?"?".concat(t.toString()):"";return y("/api/blog/posts".concat(n))},get:async e=>y("/api/blog/posts/".concat(e)),create:async e=>y("/api/blog/posts",{method:"POST",body:JSON.stringify(e)}),update:async(e,t)=>y("/api/blog/posts/".concat(e),{method:"PUT",body:JSON.stringify(t)}),delete:async e=>y("/api/blog/posts/".concat(e),{method:"DELETE"})},v={listTopics:async e=>{let t=new URLSearchParams;(null==e?void 0:e.page)&&t.set("page",String(e.page)),(null==e?void 0:e.limit)&&t.set("limit",String(e.limit));let n=t.toString()?"?".concat(t.toString()):"";return y("/api/forum/topics".concat(n))},getTopic:async e=>y("/api/forum/topics/".concat(e)),createTopic:async e=>y("/api/forum/topics",{method:"POST",body:JSON.stringify(e)}),getComments:async e=>y("/api/forum/topics/".concat(e,"/comments")),addComment:async(e,t)=>y("/api/forum/topics/".concat(e,"/comments"),{method:"POST",body:JSON.stringify(t)}),adminListTopics:async e=>{let t=new URLSearchParams;e&&t.set("search",e);let n=t.toString()?"?".concat(t.toString()):"";return y("/api/forum/admin/topics".concat(n))},adminDeleteTopic:async e=>y("/api/forum/admin/topics/".concat(e),{method:"DELETE"}),adminListComments:async()=>y("/api/forum/admin/comments"),adminDeleteComment:async e=>y("/api/forum/admin/comments/".concat(e),{method:"DELETE"})},T={list:async e=>{let t=new URLSearchParams;(null==e?void 0:e.featured)!==void 0&&t.set("featured",String(e.featured));let n=t.toString()?"?".concat(t.toString()):"";return y("/api/projects".concat(n))},get:async e=>y("/api/projects/".concat(e)),create:async e=>y("/api/projects",{method:"POST",body:JSON.stringify(e)}),update:async(e,t)=>y("/api/projects/".concat(e),{method:"PUT",body:JSON.stringify(t)}),delete:async e=>y("/api/projects/".concat(e),{method:"DELETE"})},b={list:async e=>{let t=new URLSearchParams;(null==e?void 0:e.category)&&t.set("category",e.category);let n=t.toString()?"?".concat(t.toString()):"";return y("/api/portfolio".concat(n))},get:async e=>y("/api/portfolio/".concat(e)),create:async e=>y("/api/portfolio",{method:"POST",body:JSON.stringify(e)}),update:async(e,t)=>y("/api/portfolio/".concat(e),{method:"PUT",body:JSON.stringify(t)}),delete:async e=>y("/api/portfolio/".concat(e),{method:"DELETE"})},w={list:async()=>y("/api/services"),get:async e=>y("/api/services/".concat(e)),create:async e=>y("/api/services",{method:"POST",body:JSON.stringify(e)}),update:async(e,t)=>y("/api/services/".concat(e),{method:"PUT",body:JSON.stringify(t)}),delete:async e=>y("/api/services/".concat(e),{method:"DELETE"})},k={list:async()=>y("/api/services/inquiries"),get:async e=>y("/api/services/inquiries/".concat(e)),create:async e=>y("/api/services/inquiries",{method:"POST",body:JSON.stringify(e)}),update:async(e,t)=>y("/api/services/inquiries/".concat(e),{method:"PUT",body:JSON.stringify(t)}),delete:async e=>y("/api/services/inquiries/".concat(e),{method:"DELETE"})},N={send:async e=>y("/api/contact",{method:"POST",body:JSON.stringify(e)})},E={list:async e=>{let t=new URLSearchParams;e&&t.set("search",e);let n=t.toString()?"?".concat(t.toString()):"";return y("/api/users".concat(n))},get:async e=>y("/api/users/".concat(e)),update:async(e,t)=>y("/api/users/".concat(e),{method:"PUT",body:JSON.stringify(t)}),updateRole:async(e,t)=>y("/api/users/".concat(e,"/role"),{method:"PUT",body:JSON.stringify({role:t})}),delete:async e=>y("/api/users/".concat(e),{method:"DELETE"}),stats:async()=>y("/api/users/stats/count")}},7440:function(e,t,n){n.d(t,{cn:function(){return a},p6:function(){return i}});var r=n(4839),o=n(6164);function a(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];return(0,o.m6)((0,r.W)(t))}function i(e){return new Date(e).toLocaleDateString("zh-CN",{year:"numeric",month:"long",day:"numeric"})}}}]);